# 🎉 환영합니다!

## ESP32-CAM 라인 트래킹 시스템이 완성되었습니다!

---

## 📸 시스템 소개

이 시스템은 **ESP32-CAM**에서 실시간 영상을 받아 **Python + OpenCV**로 라인을 검출하고, 
검출된 라인을 따라 차량이 자동으로 주행하도록 제어합니다.

### 화면 이미지 설명

첨부하신 이미지처럼:
- ✅ **빨간 수평선**: ROI 경계 (이 아래만 분석)
- ✅ **초록 원**: 검출된 라인의 중심점
- ✅ **실시간 처리**: 라인 위치를 추적하여 방향 결정

---

## 🚀 지금 바로 시작하기!

### 3단계로 시작

```bash
# 1단계: IP 주소 확인
# ESP32의 시리얼 모니터에서 IP 주소 확인
# 예: 192.168.0.65

# 2단계: config.py 수정
# ESP32_IP를 실제 IP로 변경

# 3단계: 실행!
./run_line_tracker.sh
```

---

## 📚 문서 가이드

### 처음 사용하시나요?
1. **QUICKSTART.md** 먼저 읽기 (5분)
2. **실행_가이드.md** 실행 방법 확인 (10분)
3. 바로 실행해보기!

### 알고리즘이 궁금하신가요?
1. **LINE_TRACKING_GUIDE.md** 읽기 (알고리즘 상세)
2. **README.md** 전체 시스템 이해

### 문제가 발생했나요?
1. **실행_가이드.md** → 🐛 자주 발생하는 문제
2. **README.md** → 🐛 문제 해결 섹션

### 코드를 이해하고 싶으신가요?
1. **프로젝트_요약.md** → 전체 구조 파악
2. 각 모듈의 코드 주석 확인 (한글로 작성됨)

---

## 🎯 추천 학습 순서

### 초급 (1일차)
```
1. QUICKSTART.md 읽기
2. config.py IP 주소 수정
3. 실행해보기
4. 화면 확인 및 파라미터 조정
```

### 중급 (2일차)
```
1. README.md 알고리즘 섹션 읽기
2. test_modules.py 실행해보기
3. 각 모듈 코드 읽어보기
4. 파라미터 튜닝
```

### 고급 (3일차)
```
1. LINE_TRACKING_GUIDE.md 정독
2. 실제 트랙에서 테스트
3. 성능 최적화
4. 확장 기능 추가
```

---

## 💡 핵심 개념 정리

### 1. ROI (Region of Interest)
화면의 **하단 50%**만 분석하여 처리 속도를 향상시킵니다.

### 2. Canny Edge Detection
이미지에서 **급격한 밝기 변화**(엣지)를 검출합니다.
흰색 라인과 검은 바닥의 경계를 찾아냅니다.

### 3. Hough Lines Transform
엣지에서 **직선**을 찾아냅니다.
여러 점들이 일직선상에 있는지 판단합니다.

### 4. 중심점 계산
검출된 모든 라인의 중심점을 평균내어 **최종 중심점**을 계산합니다.

### 5. 방향 판단
라인의 중심점과 화면 중심을 비교하여:
- **왼쪽**: 라인이 왼쪽에 있음 → 좌회전
- **오른쪽**: 라인이 오른쪽에 있음 → 우회전
- **중앙**: 라인이 중앙에 있음 → 직진

---

## 🎨 파일 구조 한눈에 보기

```
line_tracking/
│
├── 🔧 설정
│   └── config.py              # IP, 파라미터 설정
│
├── 🧩 핵심 모듈 (이 3개만 이해하면 됩니다!)
│   ├── line_detector_module.py      # 라인 찾기
│   ├── direction_judge_module.py    # 방향 결정
│   └── visualization_module.py      # 화면 표시
│
├── 🚀 실행
│   ├── main_line_tracker.py         # 메인 프로그램
│   └── run_line_tracker.sh          # 실행 스크립트
│
├── 🧪 테스트
│   └── test_modules.py              # 모듈 테스트
│
└── 📚 문서 (읽어보세요!)
    ├── 시작하기.md            ← 지금 보시는 문서
    ├── QUICKSTART.md          # 빠른 시작
    ├── 실행_가이드.md          # 실행 방법
    ├── README.md              # 전체 설명
    └── 프로젝트_요약.md        # 프로젝트 개요
```

---

## ⚡ 자주 사용하는 명령어

```bash
# 실행
./run_line_tracker.sh

# 또는
python3 main_line_tracker.py

# 테스트
python3 test_modules.py

# IP 확인
ping 192.168.0.65

# ESP32 상태 확인
curl http://192.168.0.65/status

# LED 켜기 (어두울 때)
curl "http://192.168.0.65/led?state=on"
```

---

## 🎓 다음 단계

### 1. 기본 주행 마스터하기
- [ ] 직선 코스에서 안정적으로 주행
- [ ] 파라미터 조정으로 최적화
- [ ] 다양한 조명 환경에서 테스트

### 2. 고급 기능 추가하기
- [ ] 속도 제어 API 통합
- [ ] PID 제어기 구현
- [ ] 장애물 감지 추가

### 3. 성능 개선하기
- [ ] FPS 향상 (15 FPS 목표)
- [ ] 안정성 개선
- [ ] 배터리 소비 최적화

---

## 🌟 성공 팁

### ✅ 환경 설정
- **조명**: 밝고 균일한 조명
- **라인**: 흰색 라인 + 검은 바닥 (대비가 높을수록 좋음)
- **바닥**: 평평하고 반사가 적은 표면

### ✅ 파라미터 조정
- 먼저 **처리 이미지**를 보면서 엣지가 잘 검출되는지 확인
- **데드존**을 조정하여 안정성 확보
- **FPS**를 조정하여 성능과 안정성 균형

### ✅ 디버깅
- **로그**를 보면서 오프셋 값 확인
- **화면**에서 중심점이 올바른지 확인
- **테스트 모드**로 먼저 확인 후 실제 주행

---

## 💬 자주 묻는 질문

**Q: 라인이 검출되지 않아요.**
A: `config.py`에서 `CANNY_LOW_THRESHOLD`를 50으로 낮춰보세요.

**Q: 차량이 너무 민감하게 반응해요.**
A: `DEADZONE_THRESHOLD`를 50으로 높여보세요.

**Q: FPS가 너무 낮아요.**
A: `SHOW_PROCESSED_IMAGE = False`로 설정하세요.

**Q: 곡선에서 라인을 놓쳐요.**
A: `ROI_BOTTOM_RATIO`를 0.3으로 낮춰 더 넓은 영역을 보게 하세요.

---

## 🎉 축하합니다!

이제 **ESP32-CAM 라인 트래킹 시스템**을 사용할 준비가 되었습니다!

### 이 시스템으로 할 수 있는 것:
- ✅ 실시간 라인 추적 자율주행
- ✅ OpenCV 영상 처리 학습
- ✅ 로봇 제어 시스템 이해
- ✅ 프로젝트 확장 및 개선

**즐거운 자율주행 되세요!** 🚗💨

---

## 📞 도움이 필요하신가요?

1. **실행_가이드.md** → 문제 해결 섹션
2. **README.md** → FAQ 섹션
3. **LINE_TRACKING_GUIDE.md** → 알고리즘 상세

---

**행운을 빕니다! 🍀**

